function x(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function k(n,s){for(var i=0;i<s.length;i++){var l=s[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}function P(n,s,i){return s&&k(n.prototype,s),i&&k(n,i),n}function f(n){return q(n)||D(n)||U(n)||W()}function q(n){if(Array.isArray(n))return h(n)}function D(n){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(n))return Array.from(n)}function U(n,s){if(!!n){if(typeof n=="string")return h(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(i);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(n,s)}}function h(n,s){(s==null||s>n.length)&&(s=n.length);for(var i=0,l=new Array(s);i<s;i++)l[i]=n[i];return l}function W(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var H=function(){var n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],s=function(){function d(o){var e=o.targetModal,t=o.triggers,a=t===void 0?[]:t,r=o.onShow,c=r===void 0?function(){}:r,u=o.onClose,F=u===void 0?function(){}:u,v=o.openTrigger,O=v===void 0?"data-micromodal-trigger":v,m=o.closeTrigger,B=m===void 0?"data-micromodal-close":m,b=o.openClass,N=b===void 0?"is-open":b,y=o.disableScroll,$=y===void 0?!1:y,w=o.disableFocus,I=w===void 0?!1:w,p=o.awaitCloseAnimation,j=p===void 0?!1:p,E=o.awaitOpenAnimation,_=E===void 0?!1:E,M=o.debugMode,K=M===void 0?!1:M;x(this,d),this.modal=document.getElementById(e),this.config={debugMode:K,disableScroll:$,openTrigger:O,closeTrigger:B,openClass:N,onShow:c,onClose:F,awaitCloseAnimation:j,awaitOpenAnimation:_,disableFocus:I},a.length>0&&this.registerTriggers.apply(this,f(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}return P(d,[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];a.filter(Boolean).forEach(function(c){c.addEventListener("click",function(u){return e.showModal(u)})})}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var a=function r(){e.modal.removeEventListener("animationend",r,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",a,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var a=this.config.openClass;this.modal.addEventListener("animationend",function r(){t.classList.remove(a),t.removeEventListener("animationend",r,!1)},!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(!!this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"});break}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){e.target.hasAttribute(this.config.closeTrigger)&&this.closeModal(e)}},{key:"onKeydown",value:function(e){e.keyCode===27&&this.closeModal(e),e.keyCode===9&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,f(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(t.length!==0){var a=t.filter(function(r){return!r.hasAttribute(e.config.closeTrigger)});a.length>0&&a[0].focus(),a.length===0&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(t.length!==0)if(t=t.filter(function(r){return r.offsetParent!==null}),!this.modal.contains(document.activeElement))t[0].focus();else{var a=t.indexOf(document.activeElement);e.shiftKey&&a===0&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&a===t.length-1&&(t[0].focus(),e.preventDefault())}}}]),d}(),i=null,l=function(o,e){var t=[];return o.forEach(function(a){var r=a.attributes[e].value;t[r]===void 0&&(t[r]=[]),t[r].push(a)}),t},g=function(o){if(!document.getElementById(o))return console.warn("MicroModal: \u2757Seems like you have missed %c'".concat(o,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(o,'"></div>')),!1},A=function(o){if(o.length<=0)return console.warn("MicroModal: \u2757Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'),!1},C=function(o,e){if(A(o),!e)return!0;for(var t in e)g(t);return!0},T=function(o){var e=Object.assign({},{openTrigger:"data-micromodal-trigger"},o),t=f(document.querySelectorAll("[".concat(e.openTrigger,"]"))),a=l(t,e.openTrigger);if(!(e.debugMode===!0&&C(t,a)===!1))for(var r in a){var c=a[r];e.targetModal=r,e.triggers=f(c),i=new s(e)}},L=function(o,e){var t=e||{};t.targetModal=o,!(t.debugMode===!0&&g(o)===!1)&&(i&&i.removeEventListeners(),i=new s(t),i.showModal())},S=function(o){o?i.closeModalById(o):i.closeModal()};return{init:T,show:L,close:S}}();window.MicroModal=H;export{H as default};
